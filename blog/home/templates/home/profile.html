<!DOCTYPE html>
<script type="text/javascript">
    function toggleDropDown() {
    document.getElementById("myDropdown").classList.toggle("show");
}
    // Close the dropdown if the user clicks outside of it
    window.onclick = function(e){
  if (!e.target.matches('.dropbtn')) {
    var myDropdown = document.getElementById("myDropdown");
      if (myDropdown.classList.contains('show')) {
        myDropdown.classList.remove('show');
      }
  }
}
    function getFilter() {
    document.getElementById("");
}
    /*
    Creates a new cookies or updates an old one when you click on the add to cart button
    Also updates the MainCookie to include this cookie we just added
    */
    function openWindow(obj, name, cost, weight, quantity, image){

      var result = document.getElementById(name).value //recieves the input value for how many of that item we want to add to the cart
      document.getElementById(name).value = 0; //resets the value back to 0 for the amount we want from that item
      console.log("Clicked on the button"); //check to make sure that this function is working
      if(result > 0) //make sure that you have given a quantity for that item
      {
        obj.style.background = 'green'; //change the color of the button to green to confirm that it submitted

        //creating the new cookie for that item
        var oldCookie = readCookie(name);
        if (oldCookie != "") //check to see if you have a previous cookie with this name
        {
          if(oldCookie == null)
          {
            var newCookie = createCookie(name, result + "," + cost + "," + weight + "," + quantity + "," + image, 1); //if you don't have a previous cookie, create a new one with all its values
          }
          else
          {
            var array = oldCookie.split(","); //if you do have an old one, split it and turn it into an array
            var amount = array[0]; //receive the amount that you previously have for that item
            var newCookie = createCookie(name, (Number(result) + Number(amount)) + "," + cost + "," + weight + "," + quantity + "," + image, 1); //add the current amount with the previous value to update the total amount of items you want to purchase
          }

        }
        else {
          var newCookie = createCookie(name, result + "," + cost + "," + weight + "," + quantity + "," + image, 1); //if you don't have a previous cookie, create a new one with all its values
        }

        //updating the MainCookie
        var oldMainCookie = readCookie("MainCookie"); //retrieves the MainCookie
        if (oldMainCookie != "" && oldMainCookie != null) //checks if it is currently empty
        {

          var list = oldMainCookie; //if it is not empty, store the previous value into list
          if(list.indexOf(name) == -1) //check to see if the item already exists in the list
          {
            list += name + ","; //if it does not exist, add it into the list
            var newCookie = createCookie("MainCookie",list, 1); //update the MainCookie with the new value
          }

        }
        else {
          var MainCookie = createCookie("MainCookie", name + ",", 1); //if it is empty, creates a new MainCookie with the new item stored into it
        }

        var tempMainCookie = readCookie("MainCookie"); //read the new updated value in MainCookie
        var tempCurrentCookie = readCookie(name); //read the new updated value for that item cookie
        alert("MainCookie: " + tempMainCookie + "\nJust Added Cookie\n" + name + " : " + tempCurrentCookie); //create an alert that displays this information
      }
      else {
        obj.style.background = 'red'; //if the value of the input is 0, set the color of the button to red
        alert("Please enter a value and click again"); //display that they need to enter a value
      }
    }
    /*
    Display all the cookies for the items we currently have selected
    */
    function ShowAllCookies(){

      var MainCookie = readCookie("MainCookie"); //read the MainCookie
      if (MainCookie != "" && MainCookie != null) //check if that Cookie is empty
      {
        var array = MainCookie.split(","); //split that result and turn it into an array with all the items
        var message = "";
        //for each item in the array of the MainCookie, add its value to message
        for (var i = 0; i < array.length-1; i++)
        {
          message += array[i] + ": " + readCookie(array[i]) + "\n";
        }

      }
      alert("MainCookie: " + readCookie("MainCookie") + "\n" + "Rest of the cookies: \n" + message); //display all of the cookies
    }
    /*
    Display the URL for the items' pictures
    */
    function ShowAllImages(){
      var MainCookie = readCookie("MainCookie"); //read the MainCookie
      if (MainCookie != "")
      {
        var array = MainCookie.split(","); //split that result and turn it into an array with all the items
        var message = "";

        //for each item in the array of the MainCookie
        for (var i = 0; i < array.length-1; i++)
        {
          var currentCookie = readCookie(array[i]); //read that cookie
          var innerArray = currentCookie.split(","); //split it by the commas
          message += array[i] + ": " + innerArray[4] + "\n"; //grab the URL in position 4 of the array for this cookie
        }

      }
      alert("MainCookie: " + readCookie("MainCookie") + "\n" + "Rest of the cookies: \n" + message); //display all the URLs
    }
    /*
    Display the total amount of items you have selected
    */
    function ShowAllCurrentTotal(){
      var MainCookie = readCookie("MainCookie"); //read the MainCookie
      if (MainCookie != "")
      {
        var array = MainCookie.split(","); //split that result and turn it into an array with all the items
        var message = "";

        //for each item in the array of the MainCookie
        for (var i = 0; i < array.length-1; i++)
        {
          var currentCookie = readCookie(array[i]); //read that cookie
          var innerArray = currentCookie.split(","); //split it by the commas
          message += array[i] + ": " + innerArray[0] + "\n"; //grab the current count in position 0 of the array for this cookie
        }

      }
      alert("MainCookie: " + readCookie("MainCookie") + "\n" + "Rest of the cookies: \n" + message); //display all the count counts
    }
    /*
    Display the total amount of each item that is curently available in the Database
    */
    function ShowAllQuantities(){
      var MainCookie = readCookie("MainCookie"); //read the MainCookie
      if (MainCookie != "")
      {
        var array = MainCookie.split(","); //split that result and turn it into an array with all the items
        var message = "";

        //for each item in the array of the MainCookie
        for (var i = 0; i < array.length-1; i++)
        {
          var currentCookie = readCookie(array[i]); //read that cookie
          var innerArray = currentCookie.split(","); //split it by the commas
          message += array[i] + ": " + innerArray[3] + "\n"; //grab the total amount in the database in position 3 of the array for this cookie
        }

      }
      alert("MainCookie: " + readCookie("MainCookie") + "\n" + "Rest of the cookies: \n" + message); //display all the total amounts from the database
    }
    /*
    Display all the weights per Item
    */
    function ShowAllWeights(){
      var MainCookie = readCookie("MainCookie"); //read the MainCookie
      if (MainCookie != "")
      {
        var array = MainCookie.split(","); //split that result and turn it into an array with all the items
        var message = "";

        //for each item in the array of the MainCookie
        for (var i = 0; i < array.length-1; i++)
        {
          var currentCookie = readCookie(array[i]); //read that cookie
          var innerArray = currentCookie.split(","); //split it by the commas
          message += array[i] + ": " + innerArray[2] + "\n"; //grab the weight per item in position 2 of the array for this cookie
        }

      }
      alert("MainCookie: " + readCookie("MainCookie") + "\n" + "Rest of the cookies: \n" + message); //display all the weights
    }
    /*
    Display all the costs for each item
    */
    function ShowAllCosts(){
      var MainCookie = readCookie("MainCookie"); //read the MainCookie
      if (MainCookie != "")
      {
        var array = MainCookie.split(","); //split that result and turn it into an array with all the items
        var message = "";

        //for each item in the array of the MainCookie
        for (var i = 0; i < array.length-1; i++)
        {
          var currentCookie = readCookie(array[i]); //read that cookie
          var innerArray = currentCookie.split(","); //split it by the commas
          message += array[i] + ": " + innerArray[1] + "\n"; //grab the cost per item in position 1 of the array for this cookie
        }

      }
      alert("MainCookie: " + readCookie("MainCookie") + "\n" + "Rest of the cookies: \n" + message); //display all the costs
    }
    /*
    delete all of the cookies currently held by MainCookie while also removing them from MainCookie
    */
    function DeleteAllCookies(){

      var MainCookie = readCookie("MainCookie"); //read the MainCookie
      if (MainCookie != "" && MainCookie != null)
      {
        var array = MainCookie.split(","); //split that result and turn it into an array with all the items

        //for each item in the array of the MainCookie
        for (var i = 0; i < array.length-1; i++)
        {
          eraseCookie(array[i]); //delete that item
        }
        createCookie("MainCookie", "", 1); //reset the MainCookie

      }
      alert(readCookie("MainCookie")); //display current MainCookie, which should be empty
    }
    /*
    creates a cookie with a given name, a value, and a number of days that it is active for
    */
    function createCookie(name,value,days){
      if (days)
      {
          var date = new Date();
          date.setTime(date.getTime() + (days * 24 * 60 * 60 *1000));
          var expires = "; expires=" + date.toGMTString();
      }
      else
      {
          var expires = "";
      }
      document.cookie = name + "=" + value + expires + "; path=/";
    }
    /*
    recieve information from a cookie
    */
    function readCookie(name){
      var nameEQ = name + "=";
      var ca = document.cookie.split(';');
      for(var i=0;i < ca.length;i++) {
          var c = ca[i];
          while (c.charAt(0)==' ') {
              c = c.substring(1,c.length);
          }
          if (c.indexOf(nameEQ) == 0) {
              return c.substring(nameEQ.length,c.length);
          }
      }
      return null;
    }
    /*
    erase a cookie
    */
    function eraseCookie(name){
      createCookie(name,"",-1);
    }
    function logout() {
     eraseCookie("username");
     eraseCookie("email");
     eraseCookie("tracking_id");
     DeleteAllCookies();
     eraseCookie("Destination");
     eraseCookie("csrftoken");
     eraseCookie("Total");
     eraseCookie("Store");
     eraseCookie("gsScrollPos-794");
     eraseCookie("tracking_number");

      window.location.href = '/home/';

    }

    function moveToProfile()
    {
      window.location.href = '/home/profile';
    }
</script>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script src="https://use.fontawesome.com/1335577d55.js"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">
    <link href="../../static/profile.css" rel="stylesheet">
    <script src="../../static/profile.js"></script>
    <title>{{username}}</title>
</head>
<body>
  <nav class="navbar fixed-top navbar-expand-lg navbar-dark bg-dark fixed-top">
    <div class="container">


      {% if tracking_id %}

      <script type="text/javascript">
      alert("Tracking ID: " + {{tracking_id}})
      </script>
      {% endif %}


      {% if username %}

      <script type="text/javascript">

        var username_server = '{{username}}';
       // alert("data from server :" + username_server);

        createCookie("username", username_server, 365);
        createCookie("email", '{{email}}', 365);
        alert(readCookie("username"));

      </script>


      {% endif %}

        <a class="navbar-brand" href="/home/">Group 1 Grocery Store</a>




      <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="navbar-nav ml-auto">

          <!--- Search Bar --->
           <form action="/home/search.html" type="get">
               <select id="drop_down_filter" name="drop_down_filter">
                 <option value="Categories">Categories</option>
                 <option value="Fruit">Fruits</option>
                 <option value="Vegetable">Vegetables</option>
                 <option value="Meat">Meats</option>
                 <option value="Dairy">Dairies</option>
                 <option value="Seafood">Seafood</option>
                <option value="Grains">Grains</option>
               </select>
               <input id="search_bar" type="text" name="search_bar" placeholder="Search..." class="round">
               <button id="search_submit" type="submit">Go</button>
           </form>

          <li class="nav-item" style="">
            <a class="nav-link" href="/admin/">Admin Page</a>
          </li>

          <li class="nav-item">
            <a class="nav-link" href="/home/tracking_home">Tracking</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/home/contact_us">Contact</a>
          </li>

          <!-- <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownPortfolio" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Portfolio
            </a>
            <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownPortfolio">
              <a class="dropdown-item" href="portfolio-1-col.html">1 Column Portfolio</a>
              <a class="dropdown-item" href="portfolio-2-col.html">2 Column Portfolio</a>
              <a class="dropdown-item" href="portfolio-3-col.html">3 Column Portfolio</a>
              <a class="dropdown-item" href="portfolio-4-col.html">4 Column Portfolio</a>
              <a class="dropdown-item" href="portfolio-item.html">Single Portfolio Item</a>
            </div>
          </li> -->


          <li class="nav-item">
            <a class="nav-link" href="/home/shoppingcart">
            <img src= "http://www.inmotionhosting.com/support/images/stories/icons/ecommerce/empty-cart-light.png" style="vertical-align: initial;" height="35" width="35">
            </a>

          </li>

          <li class="nav-item dropdown">

                <script type="text/javascript">
                  if(readCookie("username") != "" && readCookie("username") != null){
                    var name = readCookie("username");
                    document.write('<a class="nav-link dropdown-toggle" href="#" id="navbarDropdownBlog" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">' + name + '</a><div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownBlog">');
                     document.write(' <a class="dropdown-item" href="/home/profile">Profile</a>');
                    document.write(' <a class="dropdown-item" onclick="logout()">Log out</a></div>');
                  //  document.write('</div></li>');
                  }
                  else {
                    document.write('<a class="nav-link dropdown-toggle" href="#" id="navbarDropdownBlog" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">My Account</a><div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownBlog">');
                    document.write(' <a class="dropdown-item" href="/home/ogin_register">Log in/Register</a>');
                    // document.write(' <a class="dropdown-item" href="shoppingcart">Shopping Cart</a></div>');
                  }

                </script>

        </li>

        </ul>
      </div>
    </div>
  </nav>
<div class="fullContainer">
    <div class="inform-container">
        <div class="left-container">
            <h3 class="dash-title">Dashboard</h3>
            <ul>
                <li class="dash">
                    <button class="dashbtn">My Account</button>
                </li>

            </ul>
        </div>
        <div class="right-container">
            <div class="content-container">
                <!--Needs to get name from backend -->
                <h3 class="name-title">Overview</h3>
                <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal" data-whatever="@mdo" id="editbutton">Edit</button>
                <div style="clear: both;"></div>
                <p class="desc">From your dashboard you have the ability to view a snapshot of your recent account activity and update your account information. Select a link below to view or edit information.</p>
                <div class="column-wrapper">
                    <div class="acc-column">
                        <h3 class="column-title">Account Information</h3>
                        <h4 class="info-title">Contact Information</h4>
                        <!--Needs to get name from backend -->
                        <p class="userInfo" id="usrInfo"><script>getUsername();</script></p>
                        <p class="userInfo" id="usrEmail"><script>getEmail();</script></p>

                    </div>
                    <div class="address-column">
                        <h3 class="column-title">Address Book</h3>


                        <!--Needs to get info from backend -->
                        <button class="info-title addrbook">Manage Address (1)</button>
                        <ul>
                            <script>loadAddress();</script>
                        </ul>


                    </div>
                    <div style="clear: both;"></div>
                </div>
                <div class="payment-row">
                    <h3 class="column-title">Payment Information</h3>

                    <!--Needs to get name from backend -->
                    <button class="info-title payment">Manage Wallet (1)</button>
                    <ul>
                        <li>
                            <script>loadNumber();</script>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Create Contact Information</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form method="post" action="/home/profile/" id="accountForm" autocomplete="off">
                        {% csrf_token %}
                        <div class="page-header">
                            <h5>Address Information</h5>
                            <br>
                        </div>
                        <div class="form-group">
                            <label for="user-info-name" class="form-control-label">Name:</label>
                            <input type="text" class="form-control" id="user-name-addr" name="name-addr">
                        </div>
                        <div class="form-group">
                            <label for="message-text" class="form-control-label">Street Address:</label>
                            <input type="text" class="form-control" id="street-addr" name="street-addr">
                        </div>
                        <div class="form-group">
                            <label for="message-text" class="form-control-label">City:</label>
                            <input type="text" class="form-control" id="city-addr" name="city-addr">
                        </div>
                        <div class="form-group">
                            <label for="message-text" class="form-control-label">Zipcode:</label>
                            <input type="text" class="form-control" id="zip-addr" name="zip-addr">
                        </div>
                        <div class="form-group">
                            <label for="message-text" class="form-control-label">State (ex: CA):</label>
                            <input type="text" class="form-control" id="state-addr" name="state-addr">
                        </div>
                        <div class="page-header">
                            <h5>Payment Information</h5>
                            <br>
                        </div>
                        <div class="form-group">
                            <label for="user-info-name" class="form-control-label">Name:</label>
                            <input type="text" class="form-control" id="name-cc" name="name-cc">
                        </div>
                        <div class="form-group">
                            <label for="message-text" class="form-control-label">Zipcode:</label>
                            <input type="text" class="form-control" id="zip-cc" name="zip-cc">
                        </div>
                        <div class="form-group">
                            <label for="user-info-name" class="form-control-label">Credit Card Number:</label>
                            <input type="text" class="form-control" id="number-cc" name="number-cc" maxlength="19">
                        </div>
                        <div class="form-group">
                            <label for="user-info-name" class="form-control-label">CCV:</label>
                            <input type="text" class="form-control" id="ccv-cc" name="ccv-cc">
                        </div>
                        <div class="form-group">
                            <label for="user-info-name" class="form-control-label">EXP:</label>
                            <input type="text" class="form-control" id="exp-cc" name="exp-cc">
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                            <button type="submit" class="btn btn-primary" name="update_type" value="update" onclick="setCookie()" style="border-color: #beddff; background-color: #beddff;" disabled>Update</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
</div>
</body>
</html>
